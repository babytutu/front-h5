import{x as re,w as I,j as P,t as S,a6 as L,r as m,am as ue,an as K,o as de,ao as fe,L as H,c as _,d as D,E as U,h as u,ap as X,Q as x,aq as ve,i as N,k as V,a3 as Z,q,m as p,a as me,f as G,ar as ye,aj as he,as as ge,F as ke,p as E,n as Ce,I as J,at as Oe,Z as we,au as Ie,av as be,J as Se,ah as pe,e as Pe,g as xe}from"./main-2a870cc2.js";import{u as Q,c as Te}from"./use-expose-d9e11254.js";import{T as M,u as $,H as ze,L as Be}from"./index-4fb87c62.js";const W=Symbol();function ct(e){const t=re(W,null);t&&I(t,o=>{o&&e()})}let Le=2e3;const Ee=()=>++Le,ee={show:Boolean,zIndex:P,overlay:S,duration:P,teleport:[String,Object],lockScroll:S,lazyRender:S,beforeClose:Function,overlayStyle:Object,overlayClass:L,transitionAppear:Boolean,closeOnClickOverlay:S},it=Object.keys(ee);function Ae(e,t){return e>t?"horizontal":t>e?"vertical":""}function _e(){const e=m(0),t=m(0),o=m(0),l=m(0),n=m(0),s=m(0),a=m(""),c=m(!0),h=()=>a.value==="vertical",y=()=>a.value==="horizontal",f=()=>{o.value=0,l.value=0,n.value=0,s.value=0,a.value="",c.value=!0};return{move:v=>{const g=v.touches[0];o.value=(g.clientX<0?0:g.clientX)-e.value,l.value=g.clientY-t.value,n.value=Math.abs(o.value),s.value=Math.abs(l.value);const k=10;(!a.value||n.value<k&&s.value<k)&&(a.value=Ae(n.value,s.value)),c.value&&(n.value>M||s.value>M)&&(c.value=!1)},start:v=>{f(),e.value=v.touches[0].clientX,t.value=v.touches[0].clientY},reset:f,startX:e,startY:t,deltaX:o,deltaY:l,offsetX:n,offsetY:s,direction:a,isVertical:h,isHorizontal:y,isTap:c}}let T=0;const j="van-overflow-hidden";function De(e,t){const o=_e(),l="01",n="10",s=f=>{o.move(f);const i=o.deltaY.value>0?n:l,d=fe(f.target,e.value),{scrollHeight:v,offsetHeight:g,scrollTop:k}=d;let C="11";k===0?C=g>=v?"00":"01":k+g>=v&&(C="10"),C!=="11"&&o.isVertical()&&!(parseInt(C,2)&parseInt(i,2))&&H(f,!0)},a=()=>{document.addEventListener("touchstart",o.start),document.addEventListener("touchmove",s,{passive:!1}),T||document.body.classList.add(j),T++},c=()=>{T&&(document.removeEventListener("touchstart",o.start),document.removeEventListener("touchmove",s),T--,T||document.body.classList.remove(j))},h=()=>t()&&a(),y=()=>t()&&c();ue(h),K(y),de(y),I(t,f=>{f?a():c()})}function te(e){const t=m(!1);return I(e,o=>{o&&(t.value=o)},{immediate:!0}),o=>()=>t.value?o():null}const[Ne,Re]=_("overlay"),Me={show:Boolean,zIndex:P,duration:P,className:L,lockScroll:S,lazyRender:S,customStyle:Object};var $e=D({name:Ne,props:Me,setup(e,{slots:t}){const o=m(),l=te(()=>e.show||!e.lazyRender),n=a=>{e.lockScroll&&H(a,!0)},s=l(()=>{var a;const c=x(ve(e.zIndex),e.customStyle);return N(e.duration)&&(c.animationDuration=`${e.duration}s`),V(u("div",{ref:o,style:c,class:[Re(),e.className]},[(a=t.default)==null?void 0:a.call(t)]),[[Z,e.show]])});return U("touchmove",n,{target:o}),()=>u(X,{name:"van-fade",appear:!0},{default:s})}});const je=q($e),Ye=x({},ee,{round:Boolean,position:p("center"),closeIcon:p("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:p("top-right"),safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[Fe,Y]=_("popup");var Ke=D({name:Fe,inheritAttrs:!1,props:Ye,emits:["open","close","opened","closed","keydown","update:show","clickOverlay","clickCloseIcon"],setup(e,{emit:t,attrs:o,slots:l}){let n,s;const a=m(),c=m(),h=te(()=>e.show||!e.lazyRender),y=me(()=>{const r={zIndex:a.value};if(N(e.duration)){const O=e.position==="center"?"animationDuration":"transitionDuration";r[O]=`${e.duration}s`}return r}),f=()=>{n||(n=!0,a.value=e.zIndex!==void 0?+e.zIndex:Ee(),t("open"))},i=()=>{n&&Te(e.beforeClose,{done(){n=!1,t("close"),t("update:show",!1)}})},d=r=>{t("clickOverlay",r),e.closeOnClickOverlay&&i()},v=()=>{if(e.overlay)return u(je,E({show:e.show,class:e.overlayClass,zIndex:a.value,duration:e.duration,customStyle:e.overlayStyle,role:e.closeOnClickOverlay?"button":void 0,tabindex:e.closeOnClickOverlay?0:void 0},$(),{onClick:d}),{default:l["overlay-content"]})},g=r=>{t("clickCloseIcon",r),i()},k=()=>{if(e.closeable)return u(J,{role:"button",tabindex:0,name:e.closeIcon,class:[Y("close-icon",e.closeIconPosition),ze],classPrefix:e.iconPrefix,onClick:g},null)};let C;const ae=()=>{C&&clearTimeout(C),C=setTimeout(()=>{t("opened")})},se=()=>t("closed"),le=r=>t("keydown",r),ce=h(()=>{var r;const{round:O,position:B,safeAreaInsetTop:A,safeAreaInsetBottom:ie}=e;return V(u("div",E({ref:c,style:y.value,role:"dialog",tabindex:0,class:[Y({round:O,[B]:B}),{"van-safe-area-top":A,"van-safe-area-bottom":ie}],onKeydown:le},o,$()),[(r=l.default)==null?void 0:r.call(l),k()]),[[Z,e.show]])}),R=()=>{const{position:r,transition:O,transitionAppear:B}=e,A=r==="center"?"van-fade":`van-popup-slide-${r}`;return u(X,{name:O||A,appear:B,onAfterEnter:ae,onAfterLeave:se},{default:ce})};return I(()=>e.show,r=>{r&&!n&&(f(),o.tabindex===0&&Ce(()=>{var O;(O=c.value)==null||O.focus()})),!r&&n&&(n=!1,t("close"))}),Q({popupRef:c}),De(c,()=>e.show&&e.lockScroll),U("popstate",()=>{e.closeOnPopstate&&(i(),s=!1)}),G(()=>{e.show&&f()}),ye(()=>{s&&(t("update:show",!0),s=!1)}),K(()=>{e.show&&e.teleport&&(i(),s=!0)}),he(W,()=>e.show),()=>e.teleport?u(ge,{to:e.teleport},{default:()=>[v(),R()]}):u(ke,null,[v(),R()])}});const He=q(Ke);let z=0;function Ue(e){e?(z||document.body.classList.add("van-toast--unclickable"),z++):z&&(z--,z||document.body.classList.remove("van-toast--unclickable"))}const[Xe,b]=_("toast"),Ve=["show","overlay","teleport","transition","overlayClass","overlayStyle","closeOnClickOverlay"],Ze={icon:String,show:Boolean,type:p("text"),overlay:Boolean,message:P,iconSize:P,duration:Ie(2e3),position:p("middle"),teleport:[String,Object],wordBreak:String,className:L,iconPrefix:String,transition:p("van-fade"),loadingType:String,forbidClick:Boolean,overlayClass:L,overlayStyle:Object,closeOnClick:Boolean,closeOnClickOverlay:Boolean};var qe=D({name:Xe,props:Ze,emits:["update:show"],setup(e,{emit:t,slots:o}){let l,n=!1;const s=()=>{const i=e.show&&e.forbidClick;n!==i&&(n=i,Ue(n))},a=i=>t("update:show",i),c=()=>{e.closeOnClick&&a(!1)},h=()=>clearTimeout(l),y=()=>{const{icon:i,type:d,iconSize:v,iconPrefix:g,loadingType:k}=e;if(i||d==="success"||d==="fail")return u(J,{name:i||d,size:v,class:b("icon"),classPrefix:g},null);if(d==="loading")return u(Be,{class:b("loading"),size:v,type:k},null)},f=()=>{const{type:i,message:d}=e;if(o.message)return u("div",{class:b("text")},[o.message()]);if(N(d)&&d!=="")return i==="html"?u("div",{key:0,class:b("text"),innerHTML:String(d)},null):u("div",{class:b("text")},[d])};return I(()=>[e.show,e.forbidClick],s),I(()=>[e.show,e.type,e.message,e.duration],()=>{h(),e.show&&e.duration>0&&(l=setTimeout(()=>{a(!1)},e.duration))}),G(s),Oe(s),()=>u(He,E({class:[b([e.position,e.wordBreak==="normal"?"break-normal":e.wordBreak,{[e.type]:!e.icon}]),e.className],lockScroll:!1,onClick:c,onClosed:h,"onUpdate:show":a},we(e,Ve)),{default:()=>[y(),f()]})}});function Ge(){const e=Se({show:!1}),t=n=>{e.show=n},o=n=>{x(e,n,{transitionAppear:!0}),t(!0)},l=()=>t(!1);return Q({open:o,close:l,toggle:t}),{open:o,close:l,state:e,toggle:t}}function Je(e){const t=be(e),o=document.createElement("div");return document.body.appendChild(o),{instance:t.mount(o),unmount(){t.unmount(),document.body.removeChild(o)}}}const Qe={icon:"",type:"text",message:"",className:"",overlay:!1,onClose:void 0,onOpened:void 0,duration:2e3,teleport:"body",iconSize:void 0,iconPrefix:void 0,position:"middle",transition:"van-fade",forbidClick:!1,loadingType:void 0,overlayClass:"",overlayStyle:void 0,closeOnClick:!1,closeOnClickOverlay:!1};let w=[],We=!1,F=x({},Qe);const et=new Map;function oe(e){return pe(e)?e:{message:e}}function tt(){const{instance:e,unmount:t}=Je({setup(){const o=m(""),{open:l,state:n,close:s,toggle:a}=Ge(),c=()=>{},h=()=>u(qe,E(n,{onClosed:c,"onUpdate:show":a}),null);return I(o,y=>{n.message=y}),xe().render=h,{open:l,close:s,message:o}}});return e}function ot(){if(!w.length||We){const e=tt();w.push(e)}return w[w.length-1]}function nt(e={}){if(!Pe)return{};const t=ot(),o=oe(e);return t.open(x({},F,et.get(o.type||F.type),o)),t}const ne=e=>t=>nt(x({type:e},oe(t))),rt=ne("loading"),ut=ne("fail"),dt=e=>{w.length&&(e?(w.forEach(t=>{t.close()}),w=[]):w[0].close())};export{He as P,nt as a,te as b,dt as c,it as d,Ge as e,qe as f,ut as g,Je as m,ct as o,ee as p,rt as s,_e as u};
