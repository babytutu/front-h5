import{j as R,r as v,h as D,G as E,D as O,V as j,C as H,S as J,W as K,X as M,y as m,x as o,q as l,F as k,N as f,z as P,l as q,R as B,$ as z,K as F,T as L,v as c,J as d,U as n,u as x,H as W,Y as X,Z as Y,_ as Z,a0 as A}from"./api-6d2018c5.js";import"./tool-b11be38a.js";const I={key:0},Q={key:1},ee={key:2},ne=R({__name:"yLibrary",setup(te){const V=v([]),p=v(1),C=v("福尔摩斯"),_=v(0),g=D(()=>Math.ceil(_.value/20)),b=v(["epub"]),S=v([]),N=()=>{p.value=1,w()},T=u=>{S.value=u.length?V.value.filter(t=>u.includes(t.extension)):V.value},w=async()=>{B({duration:0,message:"加载中...",forbidClick:!0});const u=await z.post(F.api,{url:"https://api.ylibrary.org/api/search/",data:{keyword:C.value,page:p.value,sensitive:!1},method:"post"}),{hits:t,data:a}=u;_.value=t,V.value=a,T(b.value),L()},U=async u=>{B({duration:0,message:"加载中...",forbidClick:!0});const t=await z.post(F.api,{url:"https://api.ylibrary.org/api/detail/",data:{id:u,source:"zlibrary"},method:"post"}),{ipfs_cid:a}=t;L(),a||X("暂无下载");const s=`https://ipfs-checker.1kbtool.com/${a}`;Y({title:"IPFS下载",confirmButtonText:"复制",message:s}).then(()=>{G(s)})},G=u=>{const t=u.toString();let a=document.querySelector("#copy-input");a||(a=document.createElement("input"),a.id="copy-input",a.readOnly="readOnly",a.style.position="absolute",a.style.left="-1000px",a.style.zIndex="-1000",document.body.appendChild(a)),a.value=t,s(a,0,t.length),document.execCommand("copy")?(document.execCommand("copy"),Z("复制成功")):A("复制失败"),a.blur();function s(h,i,y){if(h.createTextRange){const r=h.createTextRange();r.collapse(!0),r.moveStart("character",i),r.moveEnd("character",y-i),r.select()}else h.setSelectionRange(i,y),h.focus()}};return(u,t)=>{const a=E,s=O,h=j,i=H,y=J,r=K,$=M;return c(),m(k,null,[o(h,{onSubmit:N},{default:l(()=>[o(s,{modelValue:C.value,"onUpdate:modelValue":t[0]||(t[0]=e=>C.value=e),name:"关键字",label:"关键字",placeholder:"请填写关键字",center:"",clearable:"",rules:[{required:!0,message:"请填写关键字"}]},{button:l(()=>[o(a,{size:"small",type:"primary","native-type":"submit"},{default:l(()=>[d("查询")]),_:1})]),_:1},8,["modelValue"])]),_:1}),_.value?(c(),m(k,{key:0},[o(i,null,{default:l(()=>[d("第 "+n(p.value)+" 页， 共 "+n(_.value)+" 条 / "+n(x(g))+" 页",1)]),_:1}),o(s,{name:"stepper",label:"页数"},{input:l(()=>[o(y,{modelValue:p.value,"onUpdate:modelValue":t[1]||(t[1]=e=>p.value=e),min:"1",max:x(g),onChange:w},null,8,["modelValue","max"])]),_:1}),o(s,{name:"checkboxGroup",label:"格式"},{input:l(()=>[o($,{onChange:T,modelValue:b.value,"onUpdate:modelValue":t[2]||(t[2]=e=>b.value=e),direction:"horizontal"},{default:l(()=>[o(r,{name:"epub",shape:"square"},{default:l(()=>[d("epub")]),_:1}),o(r,{name:"pdf",shape:"square"},{default:l(()=>[d("pdf")]),_:1})]),_:1},8,["modelValue"])]),_:1})],64)):f("",!0),S.value.length?(c(!0),m(k,{key:1},P(S.value,e=>(c(),q(i,{onClick:ae=>U(e.id),title:e.title,label:e.publisher,key:e},{extra:l(()=>[d(n(e.year),1)]),label:l(()=>[e.publisher?(c(),m("p",I,"出版社:"+n(e.publisher),1)):f("",!0),e.isbn?(c(),m("p",Q,"ISBN: "+n(e.isbn),1)):f("",!0),W("p",null,"格式: "+n(e.extension),1),e.author?(c(),m("p",ee,"作者："+n(e.author),1)):f("",!0)]),_:2},1032,["onClick","title","label"]))),128)):(c(),q(i,{key:2,title:"暂无结果"})),_.value?(c(),m(k,{key:3},[o(i,null,{default:l(()=>[d("第 "+n(p.value)+" 页， 共 "+n(_.value)+" 条 / "+n(x(g))+" 页",1)]),_:1}),o(s,{name:"stepper",label:"页数"},{input:l(()=>[o(y,{modelValue:p.value,"onUpdate:modelValue":t[3]||(t[3]=e=>p.value=e),min:"1",max:x(g),onChange:w},null,8,["modelValue","max"])]),_:1}),o(s,{name:"checkboxGroup",label:"格式"},{input:l(()=>[o($,{onChange:T,modelValue:b.value,"onUpdate:modelValue":t[4]||(t[4]=e=>b.value=e),direction:"horizontal"},{default:l(()=>[o(r,{name:"epub",shape:"square"},{default:l(()=>[d("epub")]),_:1}),o(r,{name:"pdf",shape:"square"},{default:l(()=>[d("pdf")]),_:1})]),_:1},8,["modelValue"])]),_:1})],64)):f("",!0)],64)}}});export{ne as default};
